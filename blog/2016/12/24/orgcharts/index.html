<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>How To Create Dynamic Org Charts With Google Sheets and Javascript</title>

  <meta name="author" content="" />
  <meta name="keywords" content="">

  

  <meta name="generator" content="Hugo 0.17" />

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6825214177384073",
      enable_page_level_ads: true
    });
  </script>

  <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

  
  <link href="http://www.ubcchemecar.com/css/animate.css" rel="stylesheet">

  
  <link href="http://www.ubcchemecar.com/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">

  
  <link href="http://www.ubcchemecar.com/css/custom.css" rel="stylesheet">

  
    

  
  <link rel="shortcut icon" href="http://www.ubcchemecar.com/img/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="http://www.ubcchemecar.com/img/apple-touch-icon.png" />
  

  <link href="http://www.ubcchemecar.com/css/owl.carousel.css" rel="stylesheet">
  <link href="http://www.ubcchemecar.com/css/owl.theme.css" rel="stylesheet">

  <link rel="alternate" href="http://www.ubcchemecar.com/index.xml" type="application/rss+xml" title="UBC Chem-E-Car: The University of British Columbia">

  
  <meta property="og:title" content="How To Create Dynamic Org Charts With Google Sheets and Javascript" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/blog/2016/12/24/orgcharts//" />
  <meta property="og:image" content="img/logo2.png" />
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/agate.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\[','\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
           extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      
      
      
      var all = MathJax.Hub.getAllJax(), i;
      for(i = 0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
  </script>
    
</head>

  <style>
  @import url('https://fonts.googleapis.com/css?family=Roboto');
  </style>

  <body>

    <div id="all">

        <header>

          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="http://www.ubcchemecar.com/">
                    <img src="http://www.ubcchemecar.com/img/logo.png" alt="How To Create Dynamic Org Charts With Google Sheets and Javascript logo" class="hidden-xs hidden-sm">
                    <img src="http://www.ubcchemecar.com/img/logo-small.png" alt="How To Create Dynamic Org Charts With Google Sheets and Javascript logo" class="visible-xs visible-sm">
                    <span class="sr-only">How To Create Dynamic Org Charts With Google Sheets and Javascript - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <i class="fa fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                    
                    <li class="dropdown">
                        <a href="http://www.ubcchemecar.com/">Home</a>
                    </li>
                    
                    <li class="dropdown">
                        <a href="http://www.ubcchemecar.com/blog/">Blog</a>
                    </li>
                    
                    <li class="dropdown">
                        <a href="http://www.ubcchemecar.com/sponsors/">Sponsors</a>
                    </li>
                    
                    <li class="dropdown">
                        <a href="http://www.ubcchemecar.com/infopack/">Recruitment</a>
                    </li>
                    
                    <li class="dropdown">
                        <a href="http://www.ubcchemecar.com/team/">Team</a>
                    </li>
                    
                    <li class="dropdown">
                        <a href="http://www.ubcchemecar.com/services/">Services</a>
                    </li>
                    
                    <li class="dropdown">
                        <a href="http://www.ubcchemecar.com/contact/">Contact</a>
                    </li>
                    
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        <div id="heading-breadcrumbs">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h1>The UBC Chem-E-Car Blog</h1>
                    </div>
                </div>
            </div>
        </div>


        <div id="content font-roboto">
            <div class="container">

                <div class="row">

                    
                    <div class="col-md-2"></div>
                    <div class="col-md-8" id="blog-post">
                        <div id="post-headers">
                          <h1 class="text-center">How To Create Dynamic Org Charts With Google Sheets and Javascript</h1>
                          <p class="author-blog-post text-center">By <i>Siang Lim</i> </p>
                          <p class="date-blog-post text-center">
                            December 24, 2016
                          </p>
                          <hr />
                        </div>

                        <div id="post-content">
                          

<h2 id="introduction">Introduction</h2>

<p>The <a href="https://developers.google.com/chart/interactive/docs/">Google Chart</a> library provides a convenient way of visualizing datasets using Javascript and embedding them in websites.</p>

<p>For our <a href="http://www.ubcchemecar.com/team/">team page</a>, we wanted to embed a dynamic orgchart that would be updated automatically using values stored in a Google Docs &lsquo;database&rsquo;. Finding online tutorials for this was a bit challenging, so here&rsquo;s our implementation.</p>

<p>If all goes well, you should get something like this, with the names, roles and relationships defined in a Google Sheet:</p>

<p><img src="http://www.ubcchemecar.com/img/blog/orgcharts/1.png" width="100%"></p>

<h2 id="how-it-works">How it works</h2>

<p>We will be using the <code>orgchart</code> package in Google Charts. Our implementation will be somewhat similar to the <a href="https://developers.google.com/chart/interactive/docs/gallery/orgchart">example</a> in the Google Charts documentation, but instead of hardcoding the values in JavaScript, we will grab them dynamically from a Google Sheet data source.</p>

<h2 id="set-up-your-google-sheet">Set up your Google Sheet</h2>

<ol>
<li>First, create a new Google Sheet with a title of your choice.</li>
<li>In the first row, fill in the first 3 columns, A to C, with &lsquo;Role&rsquo;, &lsquo;Reports To&rsquo; and &lsquo;Name&rsquo;.</li>
<li>Add in your team&rsquo;s roles, names and organizational relationships in the subsequent rows.</li>
</ol>

<p><strong>Role</strong></p>

<ul>
<li>The first column contains the role of the team member (i.e. Captain, Treasurer, Secretary). This is the green colored text in the screenshot above. The <strong>roles must be unique</strong> or the orgchart won&rsquo;t work properly. If you have multiple people with the same roles, add numbers or Roman numerals at the end (i.e. Webmaster I, Webmaster II).</li>
</ul>

<p><strong>Reports To</strong></p>

<ul>
<li>This column defines the relationships in the orgchart. Fill it up with the <strong>role</strong> that this position reports to. A blank entry will place the box at the very top of the org chart. (i.e. the <strong>Reports To</strong> entry for Captain will be blank).</li>
</ul>

<p><strong>Name</strong></p>

<ul>
<li>Self-explanatory, this column contains the names of the team members. This is the black colored text in the screenshot above.</li>
</ul>

<hr />

<p>Once you&rsquo;re done, your Google Sheet should look something like this:</p>

<p><img src="http://www.ubcchemecar.com/img/blog/orgcharts/2.png" width="50%"></p>

<h3 id="grab-your-google-sheet-data-in-json-format">Grab your Google Sheet data in JSON format</h3>

<ul>
<li>Once that&rsquo;s done, click the big blue share button on the top right corner of the screen and change the sharing settings to &lsquo;Anyone with the link <strong>Can View</strong>&rsquo;. Copy the URL for your Google Sheet from your browser, it should look something like this:</li>
</ul>

<p><code>https://docs.google.com/spreadsheets/d/1qImsDykMfz-obbMsOQo6f_IW_xmNdtScByEhcnfU3S8/edit#gid=0</code></p>

<ul>
<li>To get the data as a JSON file, modify the <code>edit#gid=0</code> part to <code>gviz/tq</code>, as below:</li>
</ul>

<blockquote>
<p><strong><code>https://docs.google.com/spreadsheets/d/1qImsDykMfz-obbMsOQo6f_IW_xmNdtScByEhcnfU3S8/gviz/tq</code></strong></p>
</blockquote>

<p>If you navigate to that link in your browser, you should get a <code>json.txt</code> file. You will need this link for the next step.</p>

<h2 id="javascript-implementation">Javascript Implementation</h2>

<p>Once the Google Sheet &lsquo;database&rsquo; has been set up, create a new <code>orgchart.html</code> (or any other name) file and paste in the following code. We will be using the <a href="https://developers.google.com/chart/interactive/docs/reference#queryobjects">Google Visualization API Query Language</a> to help us grab data from our Google Sheet.</p>

<p>Remember to replace <code>var dataSourceUrl</code> with your own Google Sheet URL. Open the file in your browser, and you should see your orgchart!</p>

<pre><code class="language-html">&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;orgchart_admin&quot;&gt;&lt;/div&gt;
  &lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;
  &lt;script type=&quot;text/javascript&quot; src=&quot;https://www.gstatic.com/charts/loader.js&quot;&gt;&lt;/script&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    google.charts.load('current', {'packages' : ['orgchart', 'table']});
    google.charts.setOnLoadCallback(function() { initialize('') });

    function initialize() {
      document.getElementById('orgchart_admin').innerHTML = &quot;&lt;i class='fa fa-spinner fa-spin fa-3x fa-fw'&gt;&lt;/i&gt;&quot;;
      
      var dataSourceUrl = 'https://docs.google.com/spreadsheets/d/1qImsDykMfz-obbMsOQo6f_IW_xmNdtScByEhcnfU3S8/gviz/tq?';

      // Tells it that the first row contains headers: 'Role', 'Reports To', 'Name'
      var query = new google.visualization.Query(dataSourceUrl + '&amp;headers=1');

      // Send the query with a callback function.
      query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
      // Called when the query response is returned.
      if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }

      var raw_data = response.getDataTable();
      var data = new google.visualization.DataTable();

      data.addColumn('string', 'Entity');
      data.addColumn('string', 'ParentEntity');
      data.addColumn('string', 'ToolTip');

      // Loops through all rows and populates a new DataTable with formatted values for the orgchart
      var num_rows = raw_data.getNumberOfRows();
      for (var i = 0; i &lt; num_rows; i++) {
        var role = raw_data.getValue(i, 0);
        var reportsTo = raw_data.getValue(i,1);
        var name = raw_data.getValue(i,2) != null ? raw_data.getValue(i,2) : '';

        data.addRows([[
          { v: role,
            f: name + &quot;&lt;div class='role'&gt;&quot; + role + &quot;&lt;/div&gt;&quot;
          }, 
          reportsTo, 
          name]]);
      }

      // Loops through all rows and populates a new DataTable with formatted values for the orgchart
      var container = document.getElementById('orgchart_admin');
      var chart = new google.visualization.OrgChart(container);
      chart.draw(data, {allowHtml:true, 'size': 'large'});
    }      
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2 id="breaking-down-the-script">Breaking down the script</h2>

<ul>
<li><p>In the <code>initialize()</code> function, we used the <code>Query</code> class to grab data from our Google Sheet. This is very similar to the <a href="https://developers.google.com/chart/interactive/docs/spreadsheets">example</a> in the documentation.</p></li>

<li><p>In the <code>handleQueryResponse()</code> callback function, if the query is successful, we can get the data as a <a href="https://developers.google.com/chart/interactive/docs/datatables_dataviews">DataTable</a> with <code>raw_data = response.getDataTable()</code>. A DataTable is essentially an array of columns and rows used by Google Charts to represent chart data.</p></li>

<li><p>We then looped through our <code>raw_data</code> and populated a new DataTable, <code>var data = new google.visualization.DataTable()</code>. We did this row by row with the <code>addRows()</code> function. We did this because the <code>orgchart</code> package takes in 3 columns, according to the <a href="https://developers.google.com/chart/interactive/docs/gallery/orgchart">documentation</a> and we want to add formatted values to the first column:</p></li>
</ul>

<p><strong>First Column</strong>
The first column is the node ID (each node is a box in the org chart) and as previously mentioned, it should be unique. We can either show the node ID in the box, or use a prettier formatted value, <code>f</code> to show in the box, but the unformatted value, <code>v</code> is still used as the ID. Having formatted values allows us to display the name and role (or optionally, even more data like pictures) in different colors in the same box.</p>

<p>In our orgchart, we want to display both the name and the role, with the role in a different color. So in the code above, we defined the formatted value as follows, with <code>div</code> tags around <code>role</code>:</p>

<pre><code class="language-javascript">f: name + &quot;&lt;div class='role'&gt;&quot; + role + &quot;&lt;/div&gt;&quot;
</code></pre>

<p><strong>Second Column</strong>
The second column defines the parent node of the current box (i.e. the relationship data) using the unformatted value, <code>v</code> of the parent node. If this is left blank, the node will be defined as a root node.</p>

<p><strong>Third Column</strong>
The third and optional column defines the tooltip text, the text that pops up when you hover your mouse over the box.</p>

<ul>
<li>Finally, in the last part of the script, we made a call to <code>new google.visualization.OrgChart()</code> to display our chart in the web page.</li>
</ul>

<pre><code class="language-javascript">var container = document.getElementById('orgchart_admin');
var chart = new google.visualization.OrgChart(container);
chart.draw(data, {allowHtml:true, 'size': 'large'});
</code></pre>

<h2 id="styling-the-org-chart">Styling the org chart</h2>

<p>So far, we&rsquo;ve managed to display our org chart, but we haven&rsquo;t added the formatting yet.</p>

<p><img src="http://www.ubcchemecar.com/img/blog/orgcharts/3.png" width="100%"></p>

<p>To change the text color for the roles in the box, we need to add some CSS. Let&rsquo;s modify the head section in the code above:</p>

<pre><code class="language-html">&lt;head&gt;
  &lt;style&gt;
  .role{
      font-size: small;
      color: #1aa;
  }   
  &lt;/style&gt;
&lt;/head&gt;
</code></pre>

<p>You should now see the font size and colors updated for the roles if you refresh your page:</p>

<p><img src="http://www.ubcchemecar.com/img/blog/orgcharts/4.png" width="100%"></p>

<p>That&rsquo;s it! Using CSS, you can also style the names by wrapping them with div tags. You can also play around with the box colors, font size and anything else in the org chart. Refer to the Google Charts <a href="https://developers.google.com/chart/interactive/docs/gallery/orgchart">documentation</a> for further information.</p>

<pre><code class="language-javascript">f: &quot;&lt;div class='name'&gt;&quot; + name + &quot;&lt;/div&gt;&quot; + &quot;&lt;div class='role'&gt;&quot; + role + &quot;&lt;/div&gt;&quot;
</code></pre>

                        </div>
                        
                        
                        <div id="comments">
                            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'ubcchemecar';
    var disqus_identifier = 'http:\/\/www.ubcchemecar.com\/blog\/2016\/12\/24\/orgcharts\/';
    var disqus_title = 'How To Create Dynamic Org Charts With Google Sheets and Javascript';
    var disqus_url = 'http:\/\/www.ubcchemecar.com\/blog\/2016\/12\/24\/orgcharts\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                        </div>
                        

                    </div>
                    

                    

                    

                    <div class="col-md-2">

                        

                        

                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        
        <div class="col-md-4 col-sm-6">
            <h4>About us</h4>

                            <p>UBC Chem-E-Car is a student-driven engineering team that represents the University of British Columbia in the annual AIChE Chem-E-Car competition.</p>
                <p>Email Us: <b><a href="mailto:team@ubcchemecar.com">team@ubcchemecar.com</a></b></p>
                

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

        <div class="col-md-4 col-sm-6">

            <h4>Recent posts</h4>

            <div class="blog-entries">
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="http://www.ubcchemecar.com/blog/2017/02/28/fuelcell/">
                          
                            <img src="http://www.ubcchemecar.com//img/blog/fuelcell/image00.jpg" class="img-responsive" alt="">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="http://www.ubcchemecar.com/blog/2017/02/28/fuelcell/">Powering The Future (Or just the Chem-E-Car)</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="http://www.ubcchemecar.com/blog/2017/02/12/finance/">
                          
                            <img src="http://www.ubcchemecar.com//img/carousel/sponsorship.png" class="img-responsive" alt="">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="http://www.ubcchemecar.com/blog/2017/02/12/finance/">Do You Even Budget?</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="http://www.ubcchemecar.com/blog/2017/02/11/elecsystem/">
                          
                            <img src="http://www.ubcchemecar.com//img/blog/elecsystem/elec1.png" class="img-responsive" alt="">
                          
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="http://www.ubcchemecar.com/blog/2017/02/11/elecsystem/">Chem-E-Car Electrical System</a></h5>
                    </div>
                </div>
                
            </div>

            <hr class="hidden-md hidden-lg">

        </div>
        

        
        <div class="col-md-4 col-sm-6">

            <h4>Contact</h4>

                             <p><strong>UBC Chem-E-Car Team</strong>
                 <br><i>Chemical and Biological Engineering Building</i>
                 <br>2360 East Mall
                 <br>Vancouver V6T 1Z3
                 <br>British Columbia, <strong>Canada</strong>
                 </p>
                

            <a href="http://www.ubcchemecar.com/contact" class="btn btn-small btn-template-main">Go to contact page</a>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">Copyright (C) 2017 UBC Chem-E-Car. All rights reserved.</p>
            
            <p class="pull-right">
              Template by <a href="http://bootstrapious.com/free-templates">Bootstrapious</a>.
              

              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>
            </p>
        </div>
    </div>
</div>





    </div>
    

    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63367875-1', 'auto');
ga('send', 'pageview');
</script>

<script src="http://www.ubcchemecar.com/js/jquery.cookie.js"></script>
<script src="http://www.ubcchemecar.com/js/waypoints.min.js"></script>
<script src="http://www.ubcchemecar.com/js/jquery.counterup.min.js"></script>
<script src="http://www.ubcchemecar.com/js/jquery.parallax-1.1.3.js"></script>
<script src="http://www.ubcchemecar.com/js/front.js"></script>


<script src="http://www.ubcchemecar.com/js/owl.carousel.min.js"></script>

  </body>
</html>
